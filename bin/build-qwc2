#!/bin/sh

startdir=`pwd`
install="yarn install --cache-folder /home/user/.cache"
configure="cp -rf /qwc2conf/* ./"
update="yarn run prod --cache-folder /home/user/.cache"
replace="cp -rf /usr/local/src/qwc2-demo-app/* /qwc2"
chuser="chpst -u ${USER}"
cd /usr/local/src/qwc2-demo-app
if [ "`id -u`" -eq 0 ]
then
    chmod o+x /root \
 && $chuser $install \
 && $chuser $configure \
 && $chuser $update \
 && chmod o-x /root \
 && echo 'Pease wait. Copying files to /qwc2...' \
 && $chuser $replace \
 && echo 'Done!'
else
    $install \
 && $configure \
 && $update \
 && echo 'Pease wait. Copying files to /qwc2...' \
 && $replace \
 && echo 'Done!'
fi
cd $startdir
exit
